{% extends 'layout.html' %}
{% block title %}
<title>Archive &middot; Ming &middot; 刘明宇 &middot; Liu Mingyu</title>
{% endblock %}
{% block css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='style/bw.css') }}">
{% endblock %}

{% block body %}
    <nav id="nav-normal" class="nav mb-4">
        <a class="nav-link navbar-brand icon-M" href="/archive"><img class="icon-M" src="{{ url_for('static', filename='img/icon/M.svg')}}"></a>
        <a id="nav-archive" class="nav-link" href="#">Archive</a>
        <a id="nav-panel" class="nav-link" href="/archive/panel">Panel</a>        
        <a class="nav-link" id="go-profile" href="../">Go to Profile</a>
    </nav>

    <!-- article list -->
    <h2>Archive</h2>

    <section id="article-list">
    {% for article in articles | reverse %}
        <div>
            <h5><a href="archive/{{article['alias']}}"><strong>{{article['title']}}</strong></a></h5>
        </div>
        <div>
            <!-- <p class="card-text">{{article['body'][0:250] | striptags}}</p> -->
            <p style="color: hsl(0, 0%, 46%);">{{article['create_date']}}</p>
            <div>{{article['preview'] | safe}}</div>
            <a href="archive/{{article['alias']}}"><i class="fas fa-book"></i> Read</a>
        </div>
        <hr>
    {% endfor %}
    </section>

    <a id="totop" href="#top" style="position: fixed; bottom: 1rem; right: 10%;"><i class="fas fa-chevron-circle-up fa-2x"></i></a>

    <script>
        window.onload = function() {
            var navpos = $('#nav-normal').offset();
            var navwidth = $('#nav-normal').width();
            $(window).bind('scroll', function() {
                // if ($(window).scrollTop() > navpos.top) {
                //     $('#nav-sticky').css('display', 'flex');
                //     $('#nav-normal').css('display', 'none');                    
                // }
                // else {
                //     $('#nav-normal').css('display', 'flex');     
                //     $('#nav-sticky').css('display', 'none');
                // }
                if ($(window).scrollTop() > ($('#nav-normal').height() + 48) / 2) {
                    $('.nav').css('position', 'fixed');
                    $('.nav').css('width', navwidth);  
                    $('.nav').css('border-bottom', '1px dashed rgba(0,0,0,.1)'); 
                }
                else {
                    $('.nav').css('position', 'relative');    
                    $('.nav').css('border-bottom', 'none');                                                    
                }
            });
        }

        $('#totop').click(function () {
            $('body,html').animate({
                scrollTop: 0
            }, 600);
            return false;
        });
        
        $(window).scroll(function () {
            if ($(this).scrollTop() > 50) {
                $('#totop').fadeIn();
            } else {
                $('#totop').fadeOut();
            }
        });

    </script>

{% endblock %}